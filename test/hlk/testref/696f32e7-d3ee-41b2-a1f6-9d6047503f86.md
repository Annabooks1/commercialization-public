---
title: Block Storage SMAPI Test
Description: Block Storage SMAPI Test
ms.assetid: 3e2a9a0b-64a9-45f1-8a33-a6fdcd8c4fb1
author: sapaetsc-msft
ms.author: sapaetsc
ms.date: 08/28/17
ms.topic: article
ms.prod: windows-hardware
ms.technology: windows-oem
---

# Block Storage SMAPI Test

<conditional_block> <conditions> <docset value="standalone"></docset> </conditions>

>[!NOTE]
You can find the latest version of this test documentation on MSDN at the following link:

-   <xref hlink="http://msdn.microsoft.com/en-us/library/windows/hardware/3e2a9a0b-64a9-45f1-8a33-a6fdcd8c4fb1">http://msdn.microsoft.com/en-us/library/windows/hardware/3e2a9a0b-64a9-45f1-8a33-a6fdcd8c4fb1</b>


</conditional_block>

This automated test verifies block storage management on a Storage Area Network (SAN) device. It does this by testing Storage Management API (SMAPI) connectivity from the SAN device (iSCSI target) to the HLK client computer (iSCSI initiator) through a storage provider.

## Test details

<table>
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<tbody>
<tr class="odd">
<td><mark type="bullet_intro">Specifications</b></td>
<td><ul>
<li>System.Server.StorageManageability.Smapi.FileStorage.BasicFunction</li>
<li>System.Server.StorageManageability.Smapi.BlockStorage.BasicFunction</li>
</ul></td>
</tr>
<tr class="even">
<td><mark type="bullet_intro">Platforms</b></td>
<td><ul>
<li><tla rid="win_threshold_server"></tla> x64</li>
</ul></td>
</tr>
<tr class="odd">
<td><mark type="bullet_intro">Supported Releases</b></td>
<td><ul>
<li><tla rid="win_10_th2"></tla></li>
<li><tla rid="win_10_rs1"></tla></li>
<li>Windows 10, version 1703</li>
<li>Windows 10, version 1709</li>
</ul></td>
</tr>
<tr class="even">
<td><mark type="bullet_intro">Expected run time (in minutes)</b></td>
<td>2</td>
</tr>
<tr class="odd">
<td><mark type="bullet_intro">Category</b></td>
<td>Compatibility</td>
</tr>
<tr class="even">
<td><mark type="bullet_intro">Timeout (in minutes)</b></td>
<td>2</td>
</tr>
<tr class="odd">
<td><mark type="bullet_intro">Requires reboot</b></td>
<td>false</td>
</tr>
<tr class="even">
<td><mark type="bullet_intro">Requires special configuration</b></td>
<td>false</td>
</tr>
<tr class="odd">
<td><mark type="bullet_intro">Type</b></td>
<td>automatic</td>
</tr>
</tbody>
</table>

## Additional documentation

Tests in this feature area might have additional documentation, including prerequisites, setup, and troubleshooting information, that can be found in the following topic(s):

-   <xref rid="p_hlk_test.system_server_additional_documentation">System.Server additional documentation</b>

## Running the test

Before running the test, you'll need the following:

-   Hardware
    -   A SAN array (and its provider) connected as an iSCSI target with the HLK client computer acting as the iSCSI initiator.
    -   Ethernet connectivity between the SAN array/provider and the host (HLK client computer).
-   Software
    -   The Windows Standards-Based Storage Management feature. If this package is not installed, the test will automatically install it. The HLK client computer requires internet connectivity for the package to be installed.
    -   The Microsoft iSCSI Initiator Service (MSiSCSI). This service comes preinstalled on the Windows operating system. If for any reason this is not installed, install it manually. The test will automatically start the MSiSCSI service if it is not running.

For this test, you must configure a SAN array connected as an iSCSI target to an iSCSI initiator (which is the HLK client computer in this case). The HLK client computer must have the Microsoft iSCSI Initiator Service installed. This service is preinstalled on a Windows operating system. If this service is not running, the test will automatically start the service.

These SAN arrays are not directly connected to host. They connect to the host through a storage provider. A storage provider can provide connectivity to one or more storage arrays.

The test requires a set of parameters to be passed before running the test. These parameters are specific to the SAN array and how it is connected to the host. The following section provides parameter details.

## Troubleshooting

For generic troubleshooting of HLK test failures, see <xref rid="p_hlk.troubleshooting_windows_hlk_test_failures">Troubleshooting Windows HLK Test Failures</b>.

A value of 0 indicates that the test was successful. A value of 1 indicates that the test failed. The HLK controller will capture this return code, and will show whether the HLK job passed or failed.

Review the test log files saved at TestDestFolder referenced in the parameter list on the HLK client computer, and fix the setup issue that is causing the test to fail.

## More information

## Parameters

| Parameter name                                 | Parameter description       |
|------------------------------------------------|-----------------------------|
| <mark type="bullet_intro">ProviderName</b>     | Name of the provider        |
| <mark type="bullet_intro">ProvisioningType</b> | Provisioning Type           |
| <mark type="bullet_intro">Username</b>         | Provider User Name          |
| <mark type="bullet_intro">Password</b>         | Provider Password           |
| <mark type="bullet_intro">Netname</b>          | Provider URI                |
| <mark type="bullet_intro">Port</b>             | Port Number                 |
| <mark type="bullet_intro">StorageSubsystem</b> | Name of Storage Subsytem    |
| <mark type="bullet_intro">TargetPortalIP</b>   | TargetPortal IP Address     |
| <mark type="bullet_intro">StoragePool</b>      | Storage Pool                |
| <mark type="bullet_intro">HostName</b>         | Host name of windows server |
| <mark type="bullet_intro">TestDestFolder</b>   | Test Destination Folder     |





