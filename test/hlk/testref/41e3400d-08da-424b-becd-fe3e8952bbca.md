---
title: WLAN Association Tests - Custom Configuration
Description: WLAN Association Tests - Custom Configuration
ms.assetid: 604d19d1-2719-42f2-845a-60496bcee832
author: sapaetsc-msft
ms.author: sapaetsc
ms.date: 08/28/17
ms.topic: article
ms.prod: windows-hardware
ms.technology: windows-oem
---

# WLAN Association Tests - Custom Configuration

<conditional_block> <conditions> <docset value="standalone"></docset> </conditions>

>[!NOTE]
You can find the latest version of this test documentation on MSDN at the following link:

-   <xref hlink="http://msdn.microsoft.com/en-us/library/windows/hardware/604d19d1-2719-42f2-845a-60496bcee832">http://msdn.microsoft.com/en-us/library/windows/hardware/604d19d1-2719-42f2-845a-60496bcee832</b>


</conditional_block>

This test suite validates the WLAN associations.

## Test details

<table>
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<tbody>
<tr class="odd">
<td><mark type="bullet_intro">Specifications</b></td>
<td><ul>
<li>Device.Network.WLAN.SupportConnectionToWiFiAP.ConnectionToWiFiAP</li>
</ul></td>
</tr>
<tr class="even">
<td><mark type="bullet_intro">Platforms</b></td>
<td><ul>
<li><tla rid="win_threshold_desktop"></tla> x64</li>
<li><tla rid="win_threshold_desktop"></tla> x86</li>
<li><tla rid="win_threshold_mobile"></tla> ARM</li>
<li><tla rid="win_threshold_desktop"></tla> ARM64</li>
<li><tla rid="win_threshold_mobile"></tla> ARM64</li>
</ul></td>
</tr>
<tr class="odd">
<td><mark type="bullet_intro">Supported Releases</b></td>
<td><ul>
<li><tla rid="win_10"></tla></li>
<li><tla rid="win_10_th2"></tla></li>
<li><tla rid="win_10_rs1"></tla></li>
<li>Windows 10, version 1703</li>
<li>Windows 10, version 1709</li>
</ul></td>
</tr>
<tr class="even">
<td><mark type="bullet_intro">Expected run time (in minutes)</b></td>
<td>20</td>
</tr>
<tr class="odd">
<td><mark type="bullet_intro">Category</b></td>
<td>Development</td>
</tr>
<tr class="even">
<td><mark type="bullet_intro">Timeout (in minutes)</b></td>
<td>20</td>
</tr>
<tr class="odd">
<td><mark type="bullet_intro">Requires reboot</b></td>
<td>false</td>
</tr>
<tr class="even">
<td><mark type="bullet_intro">Requires special configuration</b></td>
<td>true</td>
</tr>
<tr class="odd">
<td><mark type="bullet_intro">Type</b></td>
<td>automatic</td>
</tr>
</tbody>
</table>

## Additional documentation

Tests in this feature area might have additional documentation, including prerequisites, setup, and troubleshooting information, that can be found in the following topic(s):

-   <xref rid="p_hlk_test.device_network_additional_documentation">Device.Network additional documentation</b>

## Running the test

Before you run the test, complete the test setup as described in the test requirements: <xref rid="p_hlk_test.wireless_lan__80211__testing_prerequisites">Wireless LAN (802.11) Testing Prerequisites</b>.

This test allows the test scheduler (user) to run the WLAN Scan Tests with specific parameters. For each of the APs the user can specify the following via one of the CustomAP\[1|2\]Config\[24|5\]GHz:

-   SSID Broadcast Setting: Hidden or Visible
-   EAP Phase 1 Type: NONE or EAP\_PEAP or EAP\_TTLS
-   EAP Phase 2 Type: NONE or MSCHAPV2
-   Authentication Algorithm: OPEN or WEP or WPAPSK or WPA or WPA2PSK or WPA2
-   Cipher Algorithm: NONE or WEP or TKIP or AES
-   Channel: Integer Channel Number
-   Phy Type: A or B or G or N or AC

Below are the examples of AP Configs used by some of the tests:

-   Hidden.NONE.NONE.open.none.11.g
-   Visible.NONE.NONE.WPA2PSK.AES.44.n

This test performs the following actions:

-   If CustomAPConfig parameters are specified, configure two routers, that are named Router 0 and Router 1, as below. If parameters are not specified, the test does nothing.
    -   Router 0 – 2.4Ghz : Configured by user parameter Test\_CustomAP1Config24GHz
    -   Router 0 – 5Ghz : Configured by user parameter Test\_CustomAP1Config5GHz (Never used by test)
    -   Router 1 – 2.4Ghz : Configured by user parameter Test\_CustomAP2Config24GHz
    -   Router 1 – 5Ghz : Configured by user parameters Test\_CustomAP2Config5GHz
-   Execute the BasicAssociation() test steps below.
-   If Standby testing is enabled (bit 0x1 set in Test\_CustomAssociationTestOptions), execute the AssociationPowerManagementSleep() test steps below for Standby or AOAC Sleep
-   If Hibernate testing is enabled (bit 0x2 set in Test\_CustomAssociationTestOptions), execute the AssociationPowerManagementHibernate() test steps below for Hibernate

The BasicAssociation() test performs the following actions:

-   Create a TCP server on the access point (AP) controller server (listen port 7777)
-   Create a profile for Router 0 - 2.4 GHz having ConnectionMode configured as manual. If executing a FIPS mode test, the profile is configured for FIPS mode.
-   Initiate a WlanConnect using the profile.
-   Wait for up to 30 seconds for the connect to complete by using WLAN notifications.
-   Wait for IP address on the adapter
-   Connect to the TCP server on the AP controller server to confirm that full network connectivity is available.
-   Use the WLAN API GetConnectionAttributes to confirm that the association is correct and the connection is to Router 0 at 2.4 GHz.
-   Exchange TCP packets with the TCP Server on the AP controller server
-   Turn off Router 0 – 2.4 GHz
-   Delete the profile for the Router 0 – 2.4 GHz
-   Turn on Router 1 – 5 GHz (if adapter support 5 GHz) or Router 1 – 2.4 GHz (if adapter does not support 5 GHz)
-   Create a profile for appropriate Router 1 band having ConnectionMode configured as manual. If executing a FIPS mode test, the profile is configured for FIPS mode.
-   Initiate a WlanConnect using the profile.
-   Wait for up to 30 seconds for the connect to complete by using WLAN notifications.
-   Wait for IP address on the adapter
-   Connect to the TCP server on the AP controller server to confirm that full network connectivity is available.
-   Use the WLAN API GetConnectionAttributes to confirm that the association is correct and the connection is to appropriate router and band
-   Exchange TCP packets with the TCP Server on the AP controller server.
-   Delete the profile for the Router 1

The AssociationPowerManagementSleep() test first verifies that the adapter can start connected to an AP when it goes through a Standby/Connected Standby transition. Next it verifies that the adapter can switch from one AP to another after it goes through a Standby/Connected Standby transition. It performs the following actions:

-   For Sleep testing, check if system is Standby or AOAC capable. If not capable, the test fails.
-   Create a TCP server on the access point (AP) controller server (listen port 7777)
-   Turn off all routers except Router 0 – 2.4 GHz
-   Create a profile for Router 0 - 2.4 GHz having ConnectionMode configured as manual.
-   Initiate a WlanConnect using the profile.
-   Wait for upto 30 seconds for the connect to complete by using WLAN notifications.
-   Wait for IP address on the adapter
-   Connect to the TCP server on the AP controller server to confirm that full network connectivity is available.
-   Use the WLAN API GetConnectionAttributes to confirm that the association is correct and the connection is to Router 0 at 2.4 GHz.
-   Exchange TCP packets with the TCP Server on the AP controller server.
-   Depending on system either Standby or go to Connected Standby for 120 seconds
-   After wake up validate that adapter is still connected
-   Use the WLAN API GetConnectionAttributes to confirm that the association is correct and the connection is to Router 0 at 2.4 GHz.
-   Exchange TCP packets with the TCP Server on the AP controller server
-   Delete all WLAN profiles (this will disconnect the adapter)
-   The above steps have validated that the adapter can start connected to an AP when going through a Standby or Connected Standby transition. Next the test will verify transition from one AP to another.
-   Create a TCP server on the access point (AP) controller server (listen port 7777)
-   Turn off all routers except Router 0 – 2.4 GHz
-   Create a profile for Router 0 - 2.4 GHz having ConnectionMode configured as manual.
-   Initiate a WlanConnect using the profile.
-   Wait for upto 30 seconds for the connect to complete by using WLAN notifications.
-   Wait for IP address on the adapter
-   Connect to the TCP server on the AP controller server to confirm that full network connectivity is available.
-   Use the WLAN API GetConnectionAttributes to confirm that the association is correct and the connection is to Router 0 at 2.4 GHz.
-   Exchange TCP packets with the TCP Server on the AP controller server.
-   Configure the AP controller server machine to turn off the Router 0 at 2.4 GHz after 30 seconds and turn on Router 1 5GHz (if adapter supports 5GHz) or Router 1 2.4 GHz (if adapter does not support 5 GHz)
-   Depending on system either Standby or go to Connected Standby for 120 seconds
-   After wake up sleep for 30 seconds
-   Issue a Scan and Validate that the Router 1 is visible in the Scan List
-   Create a profile for Router 1 having ConnectionMode configured as manual.
-   Initiate a WlanConnect using the profile.
-   Wait for upto 30 seconds for the connect to complete by using WLAN notifications.
-   Wait for IP address on the adapter
-   Connect to the TCP server on the AP controller server to confirm that full network connectivity is available.
-   Use the WLAN API GetConnectionAttributes to confirm that the association is correct and the connection is to Router 1 and appropriate band
-   Exchange TCP packets with the TCP Server on the AP controller server.
-   Delete all WLAN profiles (this will disconnect the adapter)
-   The above steps have validated that the adapter can switch from one AP to another after it goes through a Standby or Connected Standby transition.

The AssociationPowerManagementHibernate() test first verifies that the adapter can start connected to an AP when it goes through a Hibernate transition. Next it verifies that the adapter can switch from one AP to another after it goes through a Hibernate transition. It performs the following actions:

-   For Hibernate testing, check if system is Hibernate capable. If not capable, the test completes successfully.
-   Create a TCP server on the access point (AP) controller server (listen port 7777)
-   Turn off all routers except Router 1 – 5 GHz (if adapter supports 5 GHz) or Router 1 – 2.4 GHz (if adapter does not support 5 GHz)
-   Create a profile for Router 1 appropriate band having ConnectionMode configured as manual.
-   Initiate a WlanConnect using the profile.
-   Wait for upto 30 seconds for the connect to complete by using WLAN notifications.
-   Wait for IP address on the adapter
-   Connect to the TCP server on the AP controller server to confirm that full network connectivity is available.
-   Use the WLAN API GetConnectionAttributes to confirm that the association is correct and the connection is to Router 1 and appropriate band
-   Exchange TCP packets with the TCP Server on the AP controller server.
-   Hibernate for 120 seconds
-   After wake up validate that adapter is still connected
-   Use the WLAN API GetConnectionAttributes to confirm that the association is correct and the connection is to Router 1 and appropriate band
-   Exchange TCP packets with the TCP Server on the AP controller server
-   Delete all WLAN profiles (this will disconnect the adapter)
-   The above steps have validated that the adapter can start connected to an AP when going through a Hibernate transition. Next the test will verify transition from one AP to another.
-   Create a TCP server on the access point (AP) controller server (listen port 7777)
-   Turn off all routers except Router 1 – 5 GHz (if adapter supports 5 GHz) or Router 1 – 2.4 GHz (if adapter does not support 5 GHz)
-   Create a profile for Router 1 appropriate band having ConnectionMode configured as manual.
-   Initiate a WlanConnect using the profile.
-   Wait for upto 30 seconds for the connect to complete by using WLAN notifications.
-   Wait for IP address on the adapter
-   Connect to the TCP server on the AP controller server to confirm that full network connectivity is available.
-   Use the WLAN API GetConnectionAttributes to confirm that the association is correct and the connection is to Router 1 and appropriate band
-   Exchange TCP packets with the TCP Server on the AP controller server.
-   Configure the AP controller server machine to turn off the Router 1 after 30 seconds and turn on Router 0 2.4 GHz
-   Hibernate for 120 seconds
-   After wake up sleep for 30 seconds
-   Issue a Scan and Validate that the Router 0 - 2.4 GHz is visible in the Scan List
-   Create a profile for Router 0 – 2.4GHz having ConnectionMode configured as manual.
-   Initiate a WlanConnect using the profile.
-   Wait for upto 30 seconds for the connect to complete by using WLAN notifications.
-   Wait for IP address on the adapter
-   Connect to the TCP server on the AP controller server to confirm that full network connectivity is available.
-   Use the WLAN API GetConnectionAttributes to confirm that the association is correct and the connection is to Router 0 – 2.4 GHz
-   Exchange TCP packets with the TCP Server on the AP controller server.
-   Delete all WLAN profiles (this will disconnect the adapter)
-   The above steps have validated that the adapter can switch from one AP to another after it goes through a Hibernate transition.

## Troubleshooting

For generic troubleshooting of HLK test failures, see <xref rid="p_hlk.troubleshooting_windows_hlk_test_failures">Troubleshooting Windows HLK Test Failures</b>.

For troubleshooting information, see <xref rid="p_hlk_test.troubleshooting_wireless_lan__80211__tests">Troubleshooting Wireless LAN (802.11) Tests</b>.

## More information

## Parameters

| Parameter name                                                   | Parameter description                                                                    |
|------------------------------------------------------------------|------------------------------------------------------------------------------------------|
| <mark type="bullet_intro">TestDeviceSupports5ghz</b>             | This should be set to TRUE if the device supports 5ghz networks and FALSE if it does not |
| <mark type="bullet_intro">APControllerIPAddress</b>              | Internal Parameter                                                                       |
| <mark type="bullet_intro">LocalDir</b>                           | Internal Parameter                                                                       |
| <mark type="bullet_intro">AP1IPAddress</b>                       | IP Address of the first AP connected to the system                                       |
| <mark type="bullet_intro">AP1Password</b>                        | Root password for the first AP connected to the system                                   |
| <mark type="bullet_intro">AP2IPAddress</b>                       | IP Address of the second AP connected to the system                                      |
| <mark type="bullet_intro">AP2Password</b>                        | Root password for the second AP connected to the system                                  |
| <mark type="bullet_intro">ServiceAPChannelAddress</b>            | Internal Parameter                                                                       |
| <mark type="bullet_intro">TestDll</b>                            | Internal Parameter                                                                       |
| <mark type="bullet_intro">Priority</b>                           | Internal Parameter                                                                       |
| <mark type="bullet_intro">TestName</b>                           | Internal Parameter                                                                       |
| <mark type="bullet_intro">EnableTracing</b>                      | Yes or No to enable tracing                                                              |
| <mark type="bullet_intro">Test\_CustomAP1Config24GHz</b>         | Custom config for 2.4GHz radio of first AP (Skip test by default)                        |
| <mark type="bullet_intro">Test\_CustomAP1Config5GHz</b>          | Custom config for 5GHz radio of first AP (Skip test by default)                          |
| <mark type="bullet_intro">Test\_CustomAP2Config24GHz</b>         | Custom config for 2.4GHz radio of second AP (Skip test by default)                       |
| <mark type="bullet_intro">Test\_CustomAP2Config5GHz</b>          | Custom config for 5GHz radio of second AP (Skip test by default)                         |
| <mark type="bullet_intro">Test\_CustomAssociationTestOptions</b> | Bitmask of options for Custom Association Test (0 = default)                             |





