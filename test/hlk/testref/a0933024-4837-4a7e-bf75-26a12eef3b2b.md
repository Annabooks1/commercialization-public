---
title: WLAN Roaming Tests - Custom Configuration
Description: WLAN Roaming Tests - Custom Configuration
ms.assetid: 4b4243ba-59ff-4228-94d0-e80e07f2fdee
author: sapaetsc-msft
ms.author: sapaetsc
ms.date: 08/28/17
ms.topic: article
ms.prod: windows-hardware
ms.technology: windows-oem
---

# WLAN Roaming Tests - Custom Configuration

<conditional_block> <conditions> <docset value="standalone"></docset> </conditions>

>[!NOTE]
You can find the latest version of this test documentation on MSDN at the following link:

-   <xref hlink="http://msdn.microsoft.com/en-us/library/windows/hardware/4b4243ba-59ff-4228-94d0-e80e07f2fdee">http://msdn.microsoft.com/en-us/library/windows/hardware/4b4243ba-59ff-4228-94d0-e80e07f2fdee</b>


</conditional_block>

This test suite validates that the WLAN adapter roams correctly.

## Test details

<table>
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<tbody>
<tr class="odd">
<td><mark type="bullet_intro">Specifications</b></td>
<td><ul>
<li>Device.Network.WLAN.SupportConnectionToWiFiAP.ConnectionToWiFiAP</li>
</ul></td>
</tr>
<tr class="even">
<td><mark type="bullet_intro">Platforms</b></td>
<td><ul>
<li><tla rid="win_threshold_desktop"></tla> x64</li>
<li><tla rid="win_threshold_desktop"></tla> x86</li>
<li><tla rid="win_threshold_mobile"></tla> ARM</li>
<li><tla rid="win_threshold_desktop"></tla> ARM64</li>
<li><tla rid="win_threshold_mobile"></tla> ARM64</li>
</ul></td>
</tr>
<tr class="odd">
<td><mark type="bullet_intro">Supported Releases</b></td>
<td><ul>
<li><tla rid="win_10"></tla></li>
<li><tla rid="win_10_th2"></tla></li>
<li><tla rid="win_10_rs1"></tla></li>
<li>Windows 10, version 1703</li>
<li>Windows 10, version 1709</li>
</ul></td>
</tr>
<tr class="even">
<td><mark type="bullet_intro">Expected run time (in minutes)</b></td>
<td>12</td>
</tr>
<tr class="odd">
<td><mark type="bullet_intro">Category</b></td>
<td>Development</td>
</tr>
<tr class="even">
<td><mark type="bullet_intro">Timeout (in minutes)</b></td>
<td>12</td>
</tr>
<tr class="odd">
<td><mark type="bullet_intro">Requires reboot</b></td>
<td>false</td>
</tr>
<tr class="even">
<td><mark type="bullet_intro">Requires special configuration</b></td>
<td>true</td>
</tr>
<tr class="odd">
<td><mark type="bullet_intro">Type</b></td>
<td>automatic</td>
</tr>
</tbody>
</table>

## Additional documentation

Tests in this feature area might have additional documentation, including prerequisites, setup, and troubleshooting information, that can be found in the following topic(s):

-   <xref rid="p_hlk_test.device_network_additional_documentation">Device.Network additional documentation</b>

## Running the test

Before you run the test, complete the test setup as described in the test requirements: <xref rid="p_hlk_test.wireless_lan__80211__testing_prerequisites">Wireless LAN (802.11) Testing Prerequisites</b>.

This test allows the test scheduler (user) to run the WLAN Scan Tests with specific parameters. For each of the APs the user can specify the following via one of the CustomAP\[1|2\]Config\[24|5\]GHz:

-   SSID Broadcast Setting: Hidden or Visible
-   EAP Phase 1 Type: NONE or EAP\_PEAP or EAP\_TTLS
-   EAP Phase 2 Type: NONE or MSCHAPV2
-   Authentication Algorithm: OPEN or WEP or WPAPSK or WPA or WPA2PSK or WPA2
-   Cipher Algorithm: NONE or WEP or TKIP or AES
-   Channel: Integer Channel Number
-   Phy Type: A or B or G or N or AC

Below are the examples of AP Configs used by some of the tests:

-   Hidden.NONE.NONE.open.none.11.g
-   Visible.NONE.NONE.WPA2PSK.AES.44.n

This test performs the following actions:

-   If CustomAPConfig parameters are specified, configure two routers, that are named Router 0 and Router 1, as below. If parameters are not specified, the test does nothing
    -   Router 0 – 2.4Ghz : Configured by user parameter Test\_CustomAP1Config24GHz
    -   Router 0 – 5Ghz : Configured by user parameter Test\_CustomAP1Config5GHz
    -   Router 1 – 2.4Ghz : Configured by user parameter Test\_CustomAP2Config24GHz. Except for the Channel and PhyType, other parameters must match Test\_CustomAP1Config24GHz
    -   Router 1 – 5Ghz : Configured by user parameters Test\_CustomAP2Config5GHz. Except for the Channel and PhyType, other parameters must match Test\_CustomAP1Config5GHz
    -   Router 0 and Router 1 share the same SSID for their 2.4Ghz radios.
    -   Router 0 and Router 1 share the same SSID for their 5Ghz radios.
    -   For roaming purposes, network address translation (NAT) is enabled on both routers.
-   If Sudden Drop Of Signal testing is enabled (bit 0x1 set in Test\_CustomRoamingTestOptions), execute the SuddenDropOfSignal() test steps below
-   If Sudden Loss Of Signal testing is enabled (bit 0x2 set in Test\_CustomRoamingTestOptions), execute the SuddenLossOfSignal () test steps below
-   If Gradual Drop Of Signal testing is enabled (bit 0x4 set in Test\_CustomRoamingTestOptions), execute the GradualDropOfSignal () test steps below
-   If Gradual Loss Of Signal testing is enabled (bit 0x8 set in Test\_CustomRoamingTestOptions), execute the GradualLossOfSignal () test steps below

The SuddenDropOfSignal() test performs the following actions. This test is performed first on 5 GHz (if adapter supports 5GHz) and then 2.4 GHz

-   Create a TCP server on the access point (AP) controller server (listen port 7777)
-   Turn on the radio on both routers.
-   Turn off the radio on Router 1.
-   Set the txpower1 on both routers to 84.
-   Connect to the profile by using WLANConnect and wait for WLANConnect to complete by using WLAN notifications.
-   After IP address is available on the test adapter, poll the TCP server on the AP controller to confirm that full network connectivity is available.
-   Create a connection to TCP server that is called Connection C. Send and receive packets.
-   Turn off the radio on Router 1.
-   Using Connection C, send and receive a packet. This ensures that the networksession is not dropped.
-   Use the GetConnectionAttributes WLAN API to verify that the association is correct and the connection is on Router 0 .
-   Turn on the radio on Router 1 on, and turn off the radio on Router 0.
-   Using Connection C, Send and receive a packet. This ensures that the network session is not dropped. The connection takes some time to roam.
-   Use the GetConnectionAttributes WLAN API to verify that the association is correct and the connection is on Router 1.
-   Turn on the radios on both routers.
-   Using Connection C, send and receive a packet. This ensures that the network session is not dropped.
-   Set the txpwr1 on Router 0 to 84.
-   Set the txpwr1 on Router 1 to 4.
-   Using Connection C, send and receive a packet. This ensures that the network session is not dropped.

The SuddenLossOfSignal() test performs the following actions. This test is repeated for both 5 GHz and 2.4 GHz.

-   Create a TCP server on the access point (AP) controller server (listen port 7777)
-   Turn on the radio on both routers.
-   Turn off the radio on Router 1.
-   Set the txpower1 on both routers to 84.
-   Connect to the profile by using WLANConnect and wait for WLANConnect to complete by using WLAN notifications.
-   After IP address is available on the test adapter, poll the TCP server on the AP controller to confirm that full network connectivity is available.
-   Create a connection to TCP server that is called Connection C. Send and receive packets.
-   Turn on the radio on Router 1 ,and turn off the radio on Router 0.
-   Using connection C, Send and receive a packet. This ensures that the networksession is not dropped.
-   Uses the GetConnectionAttributes WLAN API to verify that the association is correct and the connection is on Router 1 by.
-   Turn on the radio on Router 0, and turn off the radio on Router 1.
-   Using connection C, send and receive a packet. This ensures that the network session is not dropped. The connection takes some time to roam.
-   Use the GetConnectionAttributes WLAN API to verify that the association is correct and the connection is on Router 0.
-   Turn the radio on Router 1 on and the radio in Router 0 off.
-   Using connection C, Send and receive a packet. This ensures that the networksession is not dropped.
-   Use the GetConnectionAttributes WLAN API to verify that the association is correct and the connection is on Router 1.
-   Turn on the radio on Router 0, and turn off the radio on Router 1.
-   Using connection C, send and receive a packet. This ensures that the network session is not dropped.
-   Use the GetConnectionAttributes WLAN API to verify that the association is correct and the connection is on Router 0.

The GradualDropOfSignal() test performs the following actions. This test is repeated for both 5 GHz and 2.4 GHz.

-   Create a TCP server on the access point (AP) controller server (listen port 7777)
-   Turn on the radio on both routers.
-   Connect to the profile by using WLANConnect and waits for WLANConnect to complete by using WLAN notifications.
-   After IP address is available on the test adapter, poll the TCP server on the AP controller to confirm that full network connectivity is available.
-   Create a connection to TCP server that is called Connection C. Send and receive packets.
-   Set the txpower1 on Router 0 to 4 and Router 1 to 84.
-   Reduce the txpwr1 of Router 0 by 10 and increase the txpwr1 of Router 1 by 10.
-   Using connection C, sends and receives a packet. This ensures that the network session is not dropped.
-   Repeat the last two steps until the txpwer1 of Router 0 is 84 and the txpwr1 of Router 1 is 4.

The GradualLossOfSignal() test does the following. This test is repeated for both 5 GHz and 2.4 GHz.

-   Create a TCP server on the access point (AP) controller server (listen port 7777)
-   Turn on the radio on both routers.
-   Connect to the profile by using WLANConnect and wait for WLANConnect to complete by using WLAN notifications.
-   After IP addres is available on the test adapter, poll the TCP server on the AP controller to confirm that full network connectivity is available.
-   Create a connection to TCP server that is called Connection C. Send and receive packets.
-   Set the txpower1 on Router 0 to 4 and Router 1 to 84.
-   Reduce the txpwr1 of Router 0 by 10 and increase the txpwr1 of Router 1 by 10.
-   When the txpr1 of Router 1 reaches 4, turn off the router.
-   Using connection C, send and receive a packet. This ensures that the network session is not dropped.
-   Repeat the last three steps until the txpwer1 of Router 0 is 84 and the txpwr1 of Router 1 is 4.

## Troubleshooting

For generic troubleshooting of HLK test failures, see <xref rid="p_hlk.troubleshooting_windows_hlk_test_failures">Troubleshooting Windows HLK Test Failures</b>.

For troubleshooting information, see <xref rid="p_hlk_test.troubleshooting_wireless_lan__80211__tests">Troubleshooting Wireless LAN (802.11) Tests</b>.

## More information

## Parameters

| Parameter name                                               | Parameter description                                                                    |
|--------------------------------------------------------------|------------------------------------------------------------------------------------------|
| <mark type="bullet_intro">TestDeviceSupports5ghz</b>         | This should be set to TRUE if the device supports 5ghz networks and FALSE if it does not |
| <mark type="bullet_intro">APControllerIPAddress</b>          | Internal Parameter                                                                       |
| <mark type="bullet_intro">LocalDir</b>                       | Internal Parameter                                                                       |
| <mark type="bullet_intro">AP1IPAddress</b>                   | IP Address of the first AP connected to the system                                       |
| <mark type="bullet_intro">AP1Password</b>                    | Root password for the first AP connected to the system                                   |
| <mark type="bullet_intro">AP2IPAddress</b>                   | IP Address of the second AP connected to the system                                      |
| <mark type="bullet_intro">AP2Password</b>                    | Root password for the second AP connected to the system                                  |
| <mark type="bullet_intro">ServiceAPChannelAddress</b>        | Internal Parameter                                                                       |
| <mark type="bullet_intro">TestDll</b>                        | Internal Parameter                                                                       |
| <mark type="bullet_intro">Priority</b>                       | Internal Parameter                                                                       |
| <mark type="bullet_intro">TestName</b>                       | Internal Parameter                                                                       |
| <mark type="bullet_intro">EnableTracing</b>                  | Yes or No to enable tracing                                                              |
| <mark type="bullet_intro">Test\_CustomAP1Config24GHz</b>     | Custom config for 2.4GHz radio of first AP (Skip test by default)                        |
| <mark type="bullet_intro">Test\_CustomAP1Config5GHz</b>      | Custom config for 5GHz radio of first AP (Skip test by default)                          |
| <mark type="bullet_intro">Test\_CustomAP2Config24GHz</b>     | Custom config for 2.4GHz radio of second AP (Skip test by default)                       |
| <mark type="bullet_intro">Test\_CustomAP2Config5GHz</b>      | Custom config for 5GHz radio of second AP (Skip test by default)                         |
| <mark type="bullet_intro">Test\_CustomRoamingTestOptions</b> | Bitmask of options for Custom RoamingTest (0 = default)                                  |





